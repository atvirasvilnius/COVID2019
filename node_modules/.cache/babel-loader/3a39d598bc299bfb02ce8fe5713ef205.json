{"remainingRequest":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\main.js","dependencies":[{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\main.js","mtime":1582686033067},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwoKLyoNCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KLyBUaGUgZW1iZWQgSlMgZmlsZSwgdXNpbmcgYmFiZWwgYW5kIFwNClwgYnJvd3NlcmlmeS4gICAgICAgICAgICAgICAgICAgICAgIC8NCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgIFwgICBeX19eDQogICAgICAgIFwgIChvbylcX19fX19fXw0KICAgICAgICAgICAoX18pXCAgICAgICApXC9cDQogICAgICAgICAgICAgICB8fC0tLS13IHwNCiAgICAgICAgICAgICAgIHx8ICAgICB8fA0KKi8KaW1wb3J0ICcuL2Nzcy9lbWJlZC5jc3MnOwppbXBvcnQgZ2V0VVJMUGFyYW1ldGVyIGZyb20gJy4vanMvZ2V0dXJscGFyYW1zJzsKaW1wb3J0IGZldGNoRGF0YSBmcm9tICcuL2pzL2ZldGNoJzsKaW1wb3J0IGRhdGFDb25maWcgZnJvbSAnLi4vZGF0YS9jb25maWcvQ09WSUQuanNvbic7CmltcG9ydCBtYXBDb25maWcgZnJvbSAnLi4vZGF0YS9jb25maWcvbWFwLmpzb24nOwppbXBvcnQgc2l0ZUNvbmZpZyBmcm9tICcuLi9kYXRhL2NvbmZpZy9zaXRlLmpzb24nOwppbXBvcnQgY29sb3JzIGZyb20gJy4vanMvYnJlYWtzJzsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVG9DIGZyb20gJy4vY29tcG9uZW50cy90b2MudnVlJzsKaW1wb3J0IE1hcEdMIGZyb20gJy4vY29tcG9uZW50cy9tYXAudnVlJzsKaW1wb3J0IFZ1ZUNvbGxhcHNlIGZyb20gJ3Z1ZTItY29sbGFwc2UnOyAvL2ltcG9ydCBtYXBTdHlsZSBmcm9tICcuL3N0eWxlcy9wb3NpdHJvbi1zaW5nYXBvcmUuanNvbic7Ci8vIEdldCBVUkwgYXJndW1lbnRzIGlmIHBhc3NlZAovLyAgICAgbSAgIG1ldHJpYyBudW1iZXIKLy8gICAgIHkgICB5ZWFyCi8vICAgICBzICAgc2VsZWN0ZWQKLy8gICAgIHQgICBtYXAgdGl0bGUKLy8gICAgIHBpdGNoICAgIHdoZXRoZXIgbWFwIGNhbiBwaXRjaCBvciBub3QgKGRlZmF1bHQgZmFsc2UpCi8vICAgICBzbWF4em9vbSAgc2V0cyBtYXhpbXVtIHpvb20gbGV2ZWwgd2hlbiBmbHlpbmcgdG8gc2VsZWN0ZWQgbmVpZ2hib3Job29kcwovLyAgICAgdG9jcCBzZXQgd2hldGhlciBUT0MgcG9zaXRpb24gaWNvbnMgYXBwZWFyIChkZWZhdWx0IGZhbHNlKQoKdmFyIHBpdGNoID0gdHJ1ZTsKCmlmIChnZXRVUkxQYXJhbWV0ZXIoJ3BpdGNoJykgPT09ICdmYWxzZScpIHsKICBwaXRjaCA9IGZhbHNlOwp9Cgp2YXIgc21heHpvb20gPSBudWxsOwoKaWYgKGdldFVSTFBhcmFtZXRlcignc21heHpvb20nKSAhPT0gbnVsbCkgewogIHNtYXh6b29tID0gZ2V0VVJMUGFyYW1ldGVyKCdzbWF4em9vbScpOwp9IC8vIGdldCByYW5kb20gbWV0cmljIGlmIG5vbmUgcHJvdmlkZWQgYW5kIHZhbGlkYXRlIHByb3ZpZGVkCgoKdmFyIGtleXMgPSBPYmplY3Qua2V5cyhkYXRhQ29uZmlnKTsKdmFyIG1ldHJpY0lkID0gMTsKCmlmIChnZXRVUkxQYXJhbWV0ZXIoJ20nKSkgewogIHZhciBwYXNzZWRNZXRyaWMgPSBnZXRVUkxQYXJhbWV0ZXIoJ20nKTsKCiAgaWYgKGtleXMuaW5kZXhPZigibSIuY29uY2F0KHBhc3NlZE1ldHJpYykpICE9PSAtMSkgewogICAgbWV0cmljSWQgPSBwYXNzZWRNZXRyaWM7CiAgfQp9Cgp2YXIgeWVhciA9IDIwMTY7CgppZiAoZ2V0VVJMUGFyYW1ldGVyKCd5JykgIT09IG51bGwpIHsKICB5ZWFyID0gZ2V0VVJMUGFyYW1ldGVyKCd5Jyk7Cn0KCnZhciBzZWxlY3RlZCA9IFtdOwoKaWYgKGdldFVSTFBhcmFtZXRlcigncycpICE9PSBudWxsKSB7CiAgc2VsZWN0ZWQgPSBnZXRVUkxQYXJhbWV0ZXIoJ3MnKS5zcGxpdCgnLCcpOwp9Cgp2YXIgbWFwVGl0bGUgPSBudWxsOwoKaWYgKGdldFVSTFBhcmFtZXRlcigndCcpICE9PSBudWxsKSB7CiAgbWFwVGl0bGUgPSBnZXRVUkxQYXJhbWV0ZXIoJ3QnKTsKfSBlbHNlIGlmIChkYXRhQ29uZmlnWyJtIi5jb25jYXQobWV0cmljSWQpXSkgewogIG1hcFRpdGxlID0gZGF0YUNvbmZpZ1sibSIuY29uY2F0KG1ldHJpY0lkKV0uZGF0ZTsKfQoKdmFyIHRvY3AgPSBmYWxzZTsKCmlmIChnZXRVUkxQYXJhbWV0ZXIoJ3RvY3AnKSA9PT0gJ3RydWUnKSB7CiAgdG9jcCA9IHRydWU7Cn0gLy8gdGhlIHNoYXJlZCBzdGF0ZSBiZXR3ZWVuIGNvbXBvbmVudHMKCgp2YXIgYXBwU3RhdGUgPSB7CiAgbWV0cmljOiB7CiAgICBjb25maWc6IG51bGwsCiAgICB5ZWFyczogW10sCiAgICBkYXRhOiBudWxsCiAgfSwKICBjb2xvcnM6IGNvbG9ycy5icmVha3NHbkJ1NSwKICBicmVha3M6IG51bGwsCiAgc2VsZWN0ZWQ6IHNlbGVjdGVkLAogIHllYXI6IHllYXIsCiAgbWV0YWRhdGE6IG51bGwsCiAgdGl0bGU6IG1hcFRpdGxlLAogIGhpZ2hsaWdodDogW10KfTsgLy8gZm9yIGRlYnVnZ2luZwoKd2luZG93LmFwcFN0YXRlID0gYXBwU3RhdGU7IC8vIHBhcmVudC9pZnJhbWUgY29tbXVuaWNhdGlvbnMKCndpbmRvdy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZSkgewogIGlmIChlLmRhdGEudGl0bGUpIHsKICAgIGFwcFN0YXRlLnRpdGxlID0gZS5kYXRhLnRpdGxlOwogIH0KCiAgaWYgKGUuZGF0YS5tZXRyaWMpIHsKICAgIGFwcFN0YXRlLnRpdGxlID0gZGF0YUNvbmZpZ1siIi5jb25jYXQoZS5kYXRhLm1ldHJpYyldLmRhdGU7CiAgICBmZXRjaERhdGEoYXBwU3RhdGUsIGUuZGF0YS5tZXRyaWMpOwogICAgcGFyZW50LnBvc3RNZXNzYWdlKHsKICAgICAgbWFwdGl0bGU6IGFwcFN0YXRlLnRpdGxlCiAgICB9LCAnKicpOwogIH0KfTsKCmlmICh3aW5kb3cgIT0gd2luZG93LnRvcCkgewogIHBhcmVudC5wb3N0TWVzc2FnZSh7CiAgICBtYXB0aXRsZTogbWFwVGl0bGUKICB9LCAnKicpOwp9IC8vIGdyYWIgaW5pdGlhbCBkYXRhCgoKZmV0Y2hEYXRhKGFwcFN0YXRlLCBtZXRyaWNJZCk7IC8vIHNldCB1cCB2dWUgY29tcG9uZW50cwoKVG9DLmRhdGEgPSBmdW5jdGlvbiAoKSB7CiAgcmV0dXJuIHsKICAgIHNoYXJlZFN0YXRlOiBhcHBTdGF0ZSwKICAgIHByaXZhdGVTdGF0ZTogewogICAgICBtZXRhRGVzYzogbnVsbCwKICAgICAgc2VsZWN0ZWQ6IG51bGwsCiAgICAgIGFyZWE6IG51bGwsCiAgICAgIHNlbGVjdGVkUmF3OiBudWxsLAogICAgICBhcmVhUmF3OiBudWxsLAogICAgICBwb3NpdGlvblRvZ2dsZTogdG9jcAogICAgfQogIH07Cn07CgpNYXBHTC5kYXRhID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB7CiAgICBzaGFyZWRTdGF0ZTogYXBwU3RhdGUsCiAgICBwcml2YXRlU3RhdGU6IHsKICAgICAgbG9jYXRlOiBudWxsLAogICAgICBtYXBPcHRpb25zOiB7CiAgICAgICAgY29udGFpbmVyOiAnbWFwJywKICAgICAgICBzdHlsZTogJ2h0dHBzOi8vYXBpLm1hcHRpbGVyLmNvbS9tYXBzL3Bvc2l0cm9uL3N0eWxlLmpzb24/a2V5PUtEdmRpS0hYS1Q5OFdzTzIzYk5sJywKICAgICAgICBhdHRyaWJ1dGlvbkNvbnRyb2w6IGZhbHNlLAogICAgICAgIHpvb206IG1hcENvbmZpZy56b29tRW1iZWQsCiAgICAgICAgY2VudGVyOiBtYXBDb25maWcuY2VudGVyRW1iZWQsCiAgICAgICAgbWF4Qm91bmRzOiBtYXBDb25maWcubWF4Qm91bmRzLAogICAgICAgIG1pblpvb206IG1hcENvbmZpZy5taW5ab29tLAogICAgICAgIC8vcHJlc2VydmVEcmF3aW5nQnVmZmVyOiBtYXBDb25maWcucHJlc2VydmVEcmF3aW5nQnVmZmVyCiAgICAgICAgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiB0cnVlCiAgICAgIH0sCiAgICAgIHBpdGNoOiBwaXRjaCwKICAgICAgc21heHpvb206IHNtYXh6b29tLAogICAgICBtYXBMb2FkZWQ6IGZhbHNlLAogICAgICBtZXRyaWNJZDogbnVsbCwKICAgICAgZ2VvSlNPTjogbnVsbAogICAgfQogIH07Cn07CgpuZXcgVnVlKHsKICBlbDogJ3NjLXRvYycsCiAgcmVuZGVyOiBoID0+IGgoVG9DKQp9KTsKbmV3IFZ1ZSh7CiAgZWw6ICdzYy1tYXAnLAogIHJlbmRlcjogaCA9PiBoKE1hcEdMKQp9KTsgLy8gTG9hZGluZyB0aGUgcGx1Z2luIGludG8gdGhlIFZ1ZS4KClZ1ZS51c2UoVnVlQ29sbGFwc2UpOyAvLyBhdHRyaWJ1dGlvbiBsaW5rCgppZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF0dHJpYnV0aW9uIGEnKSkgewogIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hdHRyaWJ1dGlvbiBhJykuaHJlZiA9ICIiLmNvbmNhdChzaXRlQ29uZmlnLnFvbGRhc2hib2FyZFVSTCwgIj9tPW0iKS5jb25jYXQobWV0cmljSWQsICImbj0iKS5jb25jYXQoc2VsZWN0ZWQuam9pbignLCcpKTsKfQ=="},{"version":3,"sources":["C:/Users/yz.liu/Desktop/Experiment/COVID2019/src/main.js"],"names":["getURLParameter","fetchData","dataConfig","mapConfig","siteConfig","colors","Vue","ToC","MapGL","VueCollapse","pitch","smaxzoom","keys","Object","metricId","passedMetric","indexOf","year","selected","split","mapTitle","date","tocp","appState","metric","config","years","data","breaksGnBu5","breaks","metadata","title","highlight","window","onmessage","e","parent","postMessage","maptitle","top","sharedState","privateState","metaDesc","area","selectedRaw","areaRaw","positionToggle","locate","mapOptions","container","style","attributionControl","zoom","zoomEmbed","center","centerEmbed","maxBounds","minZoom","preserveDrawingBuffer","mapLoaded","geoJSON","el","render","h","use","document","querySelector","href","qoldashboardURL","join"],"mappings":"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","sourcesContent":["/*\r\n____________________________________\r\n/ The embed JS file, using babel and \\\r\n\\ browserify.                       /\r\n------------------------------------\r\n       \\   ^__^\r\n        \\  (oo)\\_______\r\n           (__)\\       )\\/\\\r\n               ||----w |\r\n               ||     ||\r\n*/\r\n\r\nimport './css/embed.css';\r\nimport getURLParameter from './js/geturlparams';\r\nimport fetchData from './js/fetch';\r\nimport dataConfig from '../data/config/COVID.json';\r\nimport mapConfig from '../data/config/map.json';\r\nimport siteConfig from '../data/config/site.json';\r\nimport colors from './js/breaks';\r\nimport Vue from 'vue';\r\nimport ToC from './components/toc.vue';\r\nimport MapGL from './components/map.vue';\r\nimport VueCollapse from 'vue2-collapse'\r\n\r\n\r\n//import mapStyle from './styles/positron-singapore.json';\r\n\r\n// Get URL arguments if passed\r\n//     m   metric number\r\n//     y   year\r\n//     s   selected\r\n//     t   map title\r\n//     pitch    whether map can pitch or not (default false)\r\n//     smaxzoom  sets maximum zoom level when flying to selected neighborhoods\r\n//     tocp set whether TOC position icons appear (default false)\r\n\r\nlet pitch = true;\r\nif (getURLParameter('pitch') === 'false') {\r\n  pitch = false;\r\n}\r\nlet smaxzoom = null;\r\nif (getURLParameter('smaxzoom') !== null) {\r\n  smaxzoom = getURLParameter('smaxzoom');\r\n}\r\n// get random metric if none provided and validate provided\r\nlet keys = Object.keys(dataConfig);\r\nlet metricId = 1;\r\nif (getURLParameter('m')) {\r\n  let passedMetric = getURLParameter('m');\r\n  if (keys.indexOf(`m${passedMetric}`) !== -1) {\r\n    metricId = passedMetric;\r\n  }\r\n}\r\nlet year = 2016;\r\nif (getURLParameter('y') !== null) {\r\n  year = getURLParameter('y');\r\n}\r\nlet selected = [];\r\nif (getURLParameter('s') !== null) {\r\n  selected = getURLParameter('s').split(',');\r\n}\r\nlet mapTitle = null;\r\nif (getURLParameter('t') !== null) {\r\n  mapTitle = getURLParameter('t');\r\n} else if (dataConfig[`m${metricId}`]) {\r\n  mapTitle = dataConfig[`m${metricId}`].date;\r\n}\r\nlet tocp = false;\r\nif (getURLParameter('tocp') === 'true') {\r\n  tocp = true;\r\n}\r\n\r\n// the shared state between components\r\nlet appState = {\r\n  metric: {\r\n    config: null,\r\n    years: [],\r\n    data: null\r\n  },\r\n  colors: colors.breaksGnBu5,\r\n  breaks: null,\r\n  selected: selected,\r\n  year: year,\r\n  metadata: null,\r\n  title: mapTitle,\r\n  highlight: []\r\n};\r\n\r\n// for debugging\r\nwindow.appState = appState;\r\n\r\n// parent/iframe communications\r\nwindow.onmessage = function(e) {\r\n  if (e.data.title) {\r\n    appState.title = e.data.title;\r\n  }\r\n  if (e.data.metric) {\r\n    appState.title = dataConfig[`${e.data.metric}`].date;\r\n    fetchData(appState, e.data.metric);\r\n    parent.postMessage(\r\n      {\r\n        maptitle: appState.title\r\n      },\r\n      '*'\r\n    );\r\n  }\r\n};\r\nif (window != window.top) {\r\n  parent.postMessage(\r\n    {\r\n      maptitle: mapTitle\r\n    },\r\n    '*'\r\n  );\r\n}\r\n\r\n// grab initial data\r\nfetchData(appState, metricId);\r\n\r\n// set up vue components\r\nToC.data = function() {\r\n  return {\r\n    sharedState: appState,\r\n    privateState: {\r\n      metaDesc: null,\r\n      selected: null,\r\n      area: null,\r\n      selectedRaw: null,\r\n      areaRaw: null,\r\n      positionToggle: tocp\r\n    }\r\n  };\r\n};\r\n\r\nMapGL.data = function() {\r\n  return {\r\n    sharedState: appState,\r\n    privateState: {\r\n      locate: null,\r\n      mapOptions: {\r\n        container: 'map',\r\n        style: 'https://api.maptiler.com/maps/positron/style.json?key=KDvdiKHXKT98WsO23bNl',\r\n        attributionControl: false,\r\n        zoom: mapConfig.zoomEmbed,\r\n        center: mapConfig.centerEmbed,\r\n        maxBounds: mapConfig.maxBounds,\r\n        minZoom: mapConfig.minZoom,\r\n        //preserveDrawingBuffer: mapConfig.preserveDrawingBuffer\r\n        preserveDrawingBuffer: true\r\n      },\r\n      pitch: pitch,\r\n      smaxzoom: smaxzoom,\r\n      mapLoaded: false,\r\n      metricId: null,\r\n      geoJSON: null\r\n    }\r\n  };\r\n};\r\n\r\nnew Vue({\r\n  el: 'sc-toc',\r\n  render: h => h(ToC)\r\n});\r\nnew Vue({\r\n  el: 'sc-map',\r\n  render: h => h(MapGL)\r\n});\r\n\r\n// Loading the plugin into the Vue.\r\nVue.use(VueCollapse)\r\n\r\n// attribution link\r\nif (document.querySelector('.attribution a')) {\r\n  document.querySelector('.attribution a').href = `${\r\n    siteConfig.qoldashboardURL\r\n  }?m=m${metricId}&n=${selected.join(',')}`;\r\n}"]}]}