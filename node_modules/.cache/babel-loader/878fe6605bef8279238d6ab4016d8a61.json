{"remainingRequest":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\js\\metric_calculations.js","dependencies":[{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\js\\metric_calculations.js","mtime":1582990926061},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlIjsKaW1wb3J0IGlzTnVtZXJpYyBmcm9tICcuL2lzbnVtZXJpYyc7CgpmdW5jdGlvbiBzdW0oYXJyKSB7CiAgdmFyIHN1bSA9IGFyci5yZWR1Y2UoZnVuY3Rpb24gKHN1bSwgeCkgewogICAgcmV0dXJuIHN1bSArIHg7CiAgfSwgMCk7CgogIGlmIChhcnIubGVuZ3RoID09PSAwKSB7CiAgICBzdW0gPSAnLS0nOwogIH0KCiAgcmV0dXJuIHN1bTsKfQoKZnVuY3Rpb24gbWVhbihhcnIpIHsKICByZXR1cm4gc3VtKGFycikgLyBhcnIubGVuZ3RoOwp9CgpmdW5jdGlvbiB3ZWlnaHRlZChhcnIsIHdlaWdodCkgewogIHZhciBzdW1SID0gc3VtKGFycik7CiAgdmFyIHN1bVcgPSBzdW0od2VpZ2h0KTsKICByZXR1cm4gc3VtUiAvIHN1bVc7Cn0KCmZ1bmN0aW9uIHZhbHNUb0FycmF5KGRhdGEsIHllYXJzLCBrZXlzKSB7CiAgdmFyIGFyciA9IFtdOwoKICBmb3IgKHZhciB5ID0gMDsgeSA8IHllYXJzLmxlbmd0aDsgeSsrKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgaWYgKGlzTnVtZXJpYyhkYXRhW2tleXNbaV1dWyJ5XyIuY29uY2F0KHllYXJzW3ldKV0pKSB7CiAgICAgICAgYXJyLnB1c2goZGF0YVtrZXlzW2ldXVsieV8iLmNvbmNhdCh5ZWFyc1t5XSldKTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gd1ZhbHNUb0FycmF5KGRhdGEsIHdlaWdodCwgeWVhcnMsIGtleXMpIHsKICB2YXIgYXJyID0gW107CgogIGZvciAodmFyIHkgPSAwOyB5IDwgeWVhcnMubGVuZ3RoOyB5KyspIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgewogICAgICBpZiAoaXNOdW1lcmljKGRhdGFba2V5c1tpXV1bInlfIi5jb25jYXQoeWVhcnNbeV0pXSkgJiYgaXNOdW1lcmljKHdlaWdodFtrZXlzW2ldXVsieV8iLmNvbmNhdCh5ZWFyc1t5XSldKSkgewogICAgICAgIGFyci5wdXNoKGRhdGFba2V5c1tpXV1bInlfIi5jb25jYXQoeWVhcnNbeV0pXSAqIHdlaWdodFtrZXlzW2ldXVsieV8iLmNvbmNhdCh5ZWFyc1t5XSldKTsKICAgICAgfQogICAgfQogIH0KCiAgcmV0dXJuIGFycjsKfQoKZnVuY3Rpb24gY2FsY1ZhbHVlKGRhdGEpIHsKICB2YXIgY2FsY1R5cGUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHN1bTsKICB2YXIgeWVhciA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwogIHZhciBrZXlzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CgogIGlmIChjYWxjVHlwZSA9PT0gJ3N1bScpIHsKICAgIHZhciBkYXRhQXJyYXkgPSB2YWxzVG9BcnJheShkYXRhLm1hcCwgW3llYXJdLCBrZXlzKTsKICAgIHJldHVybiBzdW0oZGF0YUFycmF5KTsKICB9CgogIGlmIChjYWxjVHlwZSA9PT0gJ21lYW4nKSB7CiAgICB2YXIgX2RhdGFBcnJheSA9IHZhbHNUb0FycmF5KGRhdGEubWFwLCBbeWVhcl0sIGtleXMpOwoKICAgIHJldHVybiBtZWFuKF9kYXRhQXJyYXkpOwogIH0KCiAgaWYgKGNhbGNUeXBlID09PSAnd2VpZ2h0ZWQnKSB7CiAgICB2YXIgX2RhdGFBcnJheTIgPSB3VmFsc1RvQXJyYXkoZGF0YS5tYXAsIGRhdGEudywgW3llYXJdLCBrZXlzKTsKCiAgICB2YXIgd0FycmF5ID0gdmFsc1RvQXJyYXkoZGF0YS53LCBbeWVhcl0sIGtleXMpOwogICAgcmV0dXJuIHdlaWdodGVkKF9kYXRhQXJyYXkyLCB3QXJyYXkpOwogIH0KCiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgeyBzdW0sIG1lYW4sIHdlaWdodGVkLCB2YWxzVG9BcnJheSwgd1ZhbHNUb0FycmF5LCBjYWxjVmFsdWUgfTs="},{"version":3,"sources":["C:/Users/yz.liu/Desktop/Experiment/COVID2019/src/js/metric_calculations.js"],"names":["isNumeric","sum","arr","reduce","x","length","mean","weighted","weight","sumR","sumW","valsToArray","data","years","keys","y","i","push","wValsToArray","calcValue","calcType","year","dataArray","map","w","wArray"],"mappings":"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","sourcesContent":["import isNumeric from './isnumeric';\r\n\r\nfunction sum(arr) {\r\n    let sum = arr.reduce(function(sum, x) {\r\n        return sum + x;\r\n    }, 0);\r\n    if (arr.length === 0) { sum = '--'; }\r\n    return sum;\r\n}\r\n\r\nfunction mean(arr) {\r\n    return sum(arr) / arr.length;\r\n}\r\n\r\nfunction weighted(arr, weight) {\r\n    let sumR = sum(arr);\r\n    let sumW = sum(weight);\r\n    return sumR / sumW;\r\n}\r\n\r\nfunction valsToArray(data, years, keys) {\r\n    let arr = [];\r\n    for (let y = 0; y < years.length; y++) {\r\n        for (var i = 0; i < keys.length; i++) {\r\n            if (isNumeric(data[keys[i]][`y_${years[y]}`])) {\r\n                arr.push(data[keys[i]][`y_${years[y]}`]);\r\n            }\r\n        }\r\n    }\r\n    return arr;\r\n}\r\n\r\nfunction wValsToArray(data, weight, years, keys) {\r\n    let arr = [];\r\n    for (let y = 0; y < years.length; y++) {\r\n        for (var i = 0; i < keys.length; i++) {\r\n            if (isNumeric(data[keys[i]][`y_${years[y]}`]) && isNumeric(weight[keys[i]][`y_${years[y]}`])) {\r\n                arr.push(data[keys[i]][`y_${years[y]}`] * weight[keys[i]][`y_${years[y]}`]);\r\n            }\r\n        }\r\n    }\r\n    return arr;\r\n}\r\n\r\nfunction calcValue(data, calcType = sum, year, keys) {\r\n    if (calcType === 'sum') {\r\n        let dataArray = valsToArray(data.map, [year], keys);\r\n        return sum(dataArray);\r\n    }\r\n    if (calcType === 'mean') {\r\n        let dataArray = valsToArray(data.map, [year], keys);\r\n        return mean(dataArray);\r\n    }\r\n    if (calcType === 'weighted') {\r\n        let dataArray = wValsToArray(data.map, data.w, [year], keys);\r\n        let wArray = valsToArray(data.w, [year], keys);\r\n        return weighted(dataArray, wArray);\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\nexport {sum, mean, weighted, valsToArray, wValsToArray, calcValue};\r\n"]}]}