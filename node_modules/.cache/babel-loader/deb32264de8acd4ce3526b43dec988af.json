{"remainingRequest":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\main.js","dependencies":[{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\main.js","mtime":1582689192920},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuc3BsaXQiOwoKLyoNCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KLyBUaGUgZW1iZWQgSlMgZmlsZSwgdXNpbmcgYmFiZWwgYW5kIFwNClwgYnJvd3NlcmlmeS4gICAgICAgICAgICAgICAgICAgICAgIC8NCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAgIFwgICBeX19eDQogICAgICAgIFwgIChvbylcX19fX19fXw0KICAgICAgICAgICAoX18pXCAgICAgICApXC9cDQogICAgICAgICAgICAgICB8fC0tLS13IHwNCiAgICAgICAgICAgICAgIHx8ICAgICB8fA0KKi8KaW1wb3J0ICcuL2Nzcy9lbWJlZC5jc3MnOwppbXBvcnQgZ2V0VVJMUGFyYW1ldGVyIGZyb20gJy4vanMvZ2V0dXJscGFyYW1zJzsKaW1wb3J0IGZldGNoRGF0YSBmcm9tICcuL2pzL2ZldGNoJzsKaW1wb3J0IGRhdGFDb25maWcgZnJvbSAnLi4vZGF0YS9jb25maWcvQ09WSUQuanNvbic7CmltcG9ydCBtYXBDb25maWcgZnJvbSAnLi4vZGF0YS9jb25maWcvbWFwLmpzb24nOwppbXBvcnQgc2l0ZUNvbmZpZyBmcm9tICcuLi9kYXRhL2NvbmZpZy9zaXRlLmpzb24nOwppbXBvcnQgY29sb3JzIGZyb20gJy4vanMvYnJlYWtzJzsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgVG9DIGZyb20gJy4vY29tcG9uZW50cy90b2MudnVlJzsKaW1wb3J0IE1hcEdMIGZyb20gJy4vY29tcG9uZW50cy9tYXAudnVlJzsgLy9pbXBvcnQgbWFwU3R5bGUgZnJvbSAnLi9zdHlsZXMvcG9zaXRyb24tc2luZ2Fwb3JlLmpzb24nOwovLyBHZXQgVVJMIGFyZ3VtZW50cyBpZiBwYXNzZWQKLy8gICAgIG0gICBtZXRyaWMgbnVtYmVyCi8vICAgICB5ICAgeWVhcgovLyAgICAgcyAgIHNlbGVjdGVkCi8vICAgICB0ICAgbWFwIHRpdGxlCi8vICAgICBwaXRjaCAgICB3aGV0aGVyIG1hcCBjYW4gcGl0Y2ggb3Igbm90IChkZWZhdWx0IGZhbHNlKQovLyAgICAgc21heHpvb20gIHNldHMgbWF4aW11bSB6b29tIGxldmVsIHdoZW4gZmx5aW5nIHRvIHNlbGVjdGVkIG5laWdoYm9yaG9vZHMKLy8gICAgIHRvY3Agc2V0IHdoZXRoZXIgVE9DIHBvc2l0aW9uIGljb25zIGFwcGVhciAoZGVmYXVsdCBmYWxzZSkKCnZhciBwaXRjaCA9IHRydWU7CgppZiAoZ2V0VVJMUGFyYW1ldGVyKCdwaXRjaCcpID09PSAnZmFsc2UnKSB7CiAgcGl0Y2ggPSBmYWxzZTsKfQoKdmFyIHNtYXh6b29tID0gbnVsbDsKCmlmIChnZXRVUkxQYXJhbWV0ZXIoJ3NtYXh6b29tJykgIT09IG51bGwpIHsKICBzbWF4em9vbSA9IGdldFVSTFBhcmFtZXRlcignc21heHpvb20nKTsKfSAvLyBnZXQgcmFuZG9tIG1ldHJpYyBpZiBub25lIHByb3ZpZGVkIGFuZCB2YWxpZGF0ZSBwcm92aWRlZAoKCnZhciBrZXlzID0gT2JqZWN0LmtleXMoZGF0YUNvbmZpZyk7CnZhciBtZXRyaWNJZCA9IDE7CgppZiAoZ2V0VVJMUGFyYW1ldGVyKCdtJykpIHsKICB2YXIgcGFzc2VkTWV0cmljID0gZ2V0VVJMUGFyYW1ldGVyKCdtJyk7CgogIGlmIChrZXlzLmluZGV4T2YoIm0iLmNvbmNhdChwYXNzZWRNZXRyaWMpKSAhPT0gLTEpIHsKICAgIG1ldHJpY0lkID0gcGFzc2VkTWV0cmljOwogIH0KfQoKdmFyIHllYXIgPSAyMDE2OwoKaWYgKGdldFVSTFBhcmFtZXRlcigneScpICE9PSBudWxsKSB7CiAgeWVhciA9IGdldFVSTFBhcmFtZXRlcigneScpOwp9Cgp2YXIgc2VsZWN0ZWQgPSBbXTsKCmlmIChnZXRVUkxQYXJhbWV0ZXIoJ3MnKSAhPT0gbnVsbCkgewogIHNlbGVjdGVkID0gZ2V0VVJMUGFyYW1ldGVyKCdzJykuc3BsaXQoJywnKTsKfQoKdmFyIG1hcFRpdGxlID0gbnVsbDsKCmlmIChnZXRVUkxQYXJhbWV0ZXIoJ3QnKSAhPT0gbnVsbCkgewogIG1hcFRpdGxlID0gZ2V0VVJMUGFyYW1ldGVyKCd0Jyk7Cn0gZWxzZSBpZiAoZGF0YUNvbmZpZ1sibSIuY29uY2F0KG1ldHJpY0lkKV0pIHsKICBtYXBUaXRsZSA9IGRhdGFDb25maWdbIm0iLmNvbmNhdChtZXRyaWNJZCldLmRhdGU7Cn0KCnZhciB0b2NwID0gZmFsc2U7CgppZiAoZ2V0VVJMUGFyYW1ldGVyKCd0b2NwJykgPT09ICd0cnVlJykgewogIHRvY3AgPSB0cnVlOwp9IC8vIHRoZSBzaGFyZWQgc3RhdGUgYmV0d2VlbiBjb21wb25lbnRzCgoKdmFyIGFwcFN0YXRlID0gewogIG1ldHJpYzogewogICAgY29uZmlnOiBudWxsLAogICAgeWVhcnM6IFtdLAogICAgZGF0YTogbnVsbAogIH0sCiAgY29sb3JzOiBjb2xvcnMuYnJlYWtzR25CdTUsCiAgYnJlYWtzOiBudWxsLAogIHNlbGVjdGVkOiBzZWxlY3RlZCwKICB5ZWFyOiB5ZWFyLAogIG1ldGFkYXRhOiBudWxsLAogIHRpdGxlOiBtYXBUaXRsZSwKICBoaWdobGlnaHQ6IFtdCn07IC8vIGZvciBkZWJ1Z2dpbmcKCndpbmRvdy5hcHBTdGF0ZSA9IGFwcFN0YXRlOyAvLyBwYXJlbnQvaWZyYW1lIGNvbW11bmljYXRpb25zCgp3aW5kb3cub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsKICBpZiAoZS5kYXRhLnRpdGxlKSB7CiAgICBhcHBTdGF0ZS50aXRsZSA9IGUuZGF0YS50aXRsZTsKICB9CgogIGlmIChlLmRhdGEubWV0cmljKSB7CiAgICBhcHBTdGF0ZS50aXRsZSA9IGRhdGFDb25maWdbIiIuY29uY2F0KGUuZGF0YS5tZXRyaWMpXS5kYXRlOwogICAgZmV0Y2hEYXRhKGFwcFN0YXRlLCBlLmRhdGEubWV0cmljKTsKICAgIHBhcmVudC5wb3N0TWVzc2FnZSh7CiAgICAgIG1hcHRpdGxlOiBhcHBTdGF0ZS50aXRsZQogICAgfSwgJyonKTsKICB9Cn07CgppZiAod2luZG93ICE9IHdpbmRvdy50b3ApIHsKICBwYXJlbnQucG9zdE1lc3NhZ2UoewogICAgbWFwdGl0bGU6IG1hcFRpdGxlCiAgfSwgJyonKTsKfSAvLyBncmFiIGluaXRpYWwgZGF0YQoKCmZldGNoRGF0YShhcHBTdGF0ZSwgbWV0cmljSWQpOyAvLyBzZXQgdXAgdnVlIGNvbXBvbmVudHMKClRvQy5kYXRhID0gZnVuY3Rpb24gKCkgewogIHJldHVybiB7CiAgICBzaGFyZWRTdGF0ZTogYXBwU3RhdGUsCiAgICBwcml2YXRlU3RhdGU6IHsKICAgICAgbWV0YURlc2M6IG51bGwsCiAgICAgIHNlbGVjdGVkOiBudWxsLAogICAgICBhcmVhOiBudWxsLAogICAgICBzZWxlY3RlZFJhdzogbnVsbCwKICAgICAgYXJlYVJhdzogbnVsbCwKICAgICAgcG9zaXRpb25Ub2dnbGU6IHRvY3AKICAgIH0KICB9Owp9OwoKTWFwR0wuZGF0YSA9IGZ1bmN0aW9uICgpIHsKICByZXR1cm4gewogICAgc2hhcmVkU3RhdGU6IGFwcFN0YXRlLAogICAgcHJpdmF0ZVN0YXRlOiB7CiAgICAgIGxvY2F0ZTogbnVsbCwKICAgICAgbWFwT3B0aW9uczogewogICAgICAgIGNvbnRhaW5lcjogJ21hcCcsCiAgICAgICAgc3R5bGU6ICdodHRwczovL2FwaS5tYXB0aWxlci5jb20vbWFwcy9wb3NpdHJvbi9zdHlsZS5qc29uP2tleT1LRHZkaUtIWEtUOThXc08yM2JObCcsCiAgICAgICAgYXR0cmlidXRpb25Db250cm9sOiBmYWxzZSwKICAgICAgICB6b29tOiBtYXBDb25maWcuem9vbUVtYmVkLAogICAgICAgIGNlbnRlcjogbWFwQ29uZmlnLmNlbnRlckVtYmVkLAogICAgICAgIG1heEJvdW5kczogbWFwQ29uZmlnLm1heEJvdW5kcywKICAgICAgICBtaW5ab29tOiBtYXBDb25maWcubWluWm9vbSwKICAgICAgICAvL3ByZXNlcnZlRHJhd2luZ0J1ZmZlcjogbWFwQ29uZmlnLnByZXNlcnZlRHJhd2luZ0J1ZmZlcgogICAgICAgIHByZXNlcnZlRHJhd2luZ0J1ZmZlcjogdHJ1ZQogICAgICB9LAogICAgICBwaXRjaDogcGl0Y2gsCiAgICAgIHNtYXh6b29tOiBzbWF4em9vbSwKICAgICAgbWFwTG9hZGVkOiBmYWxzZSwKICAgICAgbWV0cmljSWQ6IG51bGwsCiAgICAgIGdlb0pTT046IG51bGwKICAgIH0KICB9Owp9OwoKbmV3IFZ1ZSh7CiAgZWw6ICdzYy10b2MnLAogIHJlbmRlcjogaCA9PiBoKFRvQykKfSk7Cm5ldyBWdWUoewogIGVsOiAnc2MtbWFwJywKICByZW5kZXI6IGggPT4gaChNYXBHTCkKfSk7IC8vIGF0dHJpYnV0aW9uIGxpbmsKCmlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXR0cmlidXRpb24gYScpKSB7CiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmF0dHJpYnV0aW9uIGEnKS5ocmVmID0gIiIuY29uY2F0KHNpdGVDb25maWcucW9sZGFzaGJvYXJkVVJMLCAiP209bSIpLmNvbmNhdChtZXRyaWNJZCwgIiZuPSIpLmNvbmNhdChzZWxlY3RlZC5qb2luKCcsJykpOwp9"},{"version":3,"sources":["C:/Users/yz.liu/Desktop/Experiment/COVID2019/src/main.js"],"names":["getURLParameter","fetchData","dataConfig","mapConfig","siteConfig","colors","Vue","ToC","MapGL","pitch","smaxzoom","keys","Object","metricId","passedMetric","indexOf","year","selected","split","mapTitle","date","tocp","appState","metric","config","years","data","breaksGnBu5","breaks","metadata","title","highlight","window","onmessage","e","parent","postMessage","maptitle","top","sharedState","privateState","metaDesc","area","selectedRaw","areaRaw","positionToggle","locate","mapOptions","container","style","attributionControl","zoom","zoomEmbed","center","centerEmbed","maxBounds","minZoom","preserveDrawingBuffer","mapLoaded","geoJSON","el","render","h","document","querySelector","href","qoldashboardURL","join"],"mappings":"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","sourcesContent":["/*\r\n____________________________________\r\n/ The embed JS file, using babel and \\\r\n\\ browserify.                       /\r\n------------------------------------\r\n       \\   ^__^\r\n        \\  (oo)\\_______\r\n           (__)\\       )\\/\\\r\n               ||----w |\r\n               ||     ||\r\n*/\r\n\r\nimport './css/embed.css';\r\nimport getURLParameter from './js/geturlparams';\r\nimport fetchData from './js/fetch';\r\nimport dataConfig from '../data/config/COVID.json';\r\nimport mapConfig from '../data/config/map.json';\r\nimport siteConfig from '../data/config/site.json';\r\nimport colors from './js/breaks';\r\nimport Vue from 'vue';\r\nimport ToC from './components/toc.vue';\r\nimport MapGL from './components/map.vue';\r\n\r\n//import mapStyle from './styles/positron-singapore.json';\r\n\r\n// Get URL arguments if passed\r\n//     m   metric number\r\n//     y   year\r\n//     s   selected\r\n//     t   map title\r\n//     pitch    whether map can pitch or not (default false)\r\n//     smaxzoom  sets maximum zoom level when flying to selected neighborhoods\r\n//     tocp set whether TOC position icons appear (default false)\r\n\r\nlet pitch = true;\r\nif (getURLParameter('pitch') === 'false') {\r\n  pitch = false;\r\n}\r\nlet smaxzoom = null;\r\nif (getURLParameter('smaxzoom') !== null) {\r\n  smaxzoom = getURLParameter('smaxzoom');\r\n}\r\n// get random metric if none provided and validate provided\r\nlet keys = Object.keys(dataConfig);\r\nlet metricId = 1;\r\nif (getURLParameter('m')) {\r\n  let passedMetric = getURLParameter('m');\r\n  if (keys.indexOf(`m${passedMetric}`) !== -1) {\r\n    metricId = passedMetric;\r\n  }\r\n}\r\nlet year = 2016;\r\nif (getURLParameter('y') !== null) {\r\n  year = getURLParameter('y');\r\n}\r\nlet selected = [];\r\nif (getURLParameter('s') !== null) {\r\n  selected = getURLParameter('s').split(',');\r\n}\r\nlet mapTitle = null;\r\nif (getURLParameter('t') !== null) {\r\n  mapTitle = getURLParameter('t');\r\n} else if (dataConfig[`m${metricId}`]) {\r\n  mapTitle = dataConfig[`m${metricId}`].date;\r\n}\r\nlet tocp = false;\r\nif (getURLParameter('tocp') === 'true') {\r\n  tocp = true;\r\n}\r\n\r\n// the shared state between components\r\nlet appState = {\r\n  metric: {\r\n    config: null,\r\n    years: [],\r\n    data: null\r\n  },\r\n  colors: colors.breaksGnBu5,\r\n  breaks: null,\r\n  selected: selected,\r\n  year: year,\r\n  metadata: null,\r\n  title: mapTitle,\r\n  highlight: []\r\n};\r\n\r\n// for debugging\r\nwindow.appState = appState;\r\n\r\n// parent/iframe communications\r\nwindow.onmessage = function(e) {\r\n  if (e.data.title) {\r\n    appState.title = e.data.title;\r\n  }\r\n  if (e.data.metric) {\r\n    appState.title = dataConfig[`${e.data.metric}`].date;\r\n    fetchData(appState, e.data.metric);\r\n    parent.postMessage(\r\n      {\r\n        maptitle: appState.title\r\n      },\r\n      '*'\r\n    );\r\n  }\r\n};\r\nif (window != window.top) {\r\n  parent.postMessage(\r\n    {\r\n      maptitle: mapTitle\r\n    },\r\n    '*'\r\n  );\r\n}\r\n\r\n// grab initial data\r\nfetchData(appState, metricId);\r\n\r\n// set up vue components\r\nToC.data = function() {\r\n  return {\r\n    sharedState: appState,\r\n    privateState: {\r\n      metaDesc: null,\r\n      selected: null,\r\n      area: null,\r\n      selectedRaw: null,\r\n      areaRaw: null,\r\n      positionToggle: tocp\r\n    }\r\n  };\r\n};\r\n\r\nMapGL.data = function() {\r\n  return {\r\n    sharedState: appState,\r\n    privateState: {\r\n      locate: null,\r\n      mapOptions: {\r\n        container: 'map',\r\n        style: 'https://api.maptiler.com/maps/positron/style.json?key=KDvdiKHXKT98WsO23bNl',\r\n        attributionControl: false,\r\n        zoom: mapConfig.zoomEmbed,\r\n        center: mapConfig.centerEmbed,\r\n        maxBounds: mapConfig.maxBounds,\r\n        minZoom: mapConfig.minZoom,\r\n        //preserveDrawingBuffer: mapConfig.preserveDrawingBuffer\r\n        preserveDrawingBuffer: true\r\n      },\r\n      pitch: pitch,\r\n      smaxzoom: smaxzoom,\r\n      mapLoaded: false,\r\n      metricId: null,\r\n      geoJSON: null\r\n    }\r\n  };\r\n};\r\n\r\nnew Vue({\r\n  el: 'sc-toc',\r\n  render: h => h(ToC)\r\n});\r\nnew Vue({\r\n  el: 'sc-map',\r\n  render: h => h(MapGL)\r\n});\r\n\r\n// attribution link\r\nif (document.querySelector('.attribution a')) {\r\n  document.querySelector('.attribution a').href = `${\r\n    siteConfig.qoldashboardURL\r\n  }?m=m${metricId}&n=${selected.join(',')}`;\r\n}"]}]}