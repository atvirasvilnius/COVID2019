{"remainingRequest":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\components\\map.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\src\\components\\map.vue","mtime":1582125739877},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\yz.liu\\Desktop\\Experiment\\COVID2019\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgbWFwYm94Z2wgZnJvbSAnbWFwYm94LWdsJzsNCmltcG9ydCBnZW9qc29uRGF0YU1lcmdlIGZyb20gJy4uL2pzL2dlb2pzb25kYXRhbWVyZ2UnOw0KaW1wb3J0IHsNCiAgcHJldHR5TnVtYmVyDQp9IGZyb20gJy4uL2pzL251bWJlcl9mb3JtYXQnOw0KaW1wb3J0IGdldFVSTFBhcmFtZXRlciBmcm9tICcuLi9qcy9nZXR1cmxwYXJhbXMnOw0KaW1wb3J0IHsNCiAgc2NhbGVMaW5lYXINCn0gZnJvbSAnZDMtc2NhbGUnOw0KaW1wb3J0IGdlb2cgZnJvbSAnLi4vLi4vZGF0YS9nZW9ncmFwaHkuZ2VvanNvbi5qc29uJzsNCmltcG9ydCB2aXJvdXNnZW9nIGZyb20gJy4uLy4uL2RhdGEvY29uZmlnL0NPVklELmdlb2pzb24uanNvbic7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ3NjLW1hcCcsDQogIHdhdGNoOiB7DQogICAgJ3NoYXJlZFN0YXRlLnNlbGVjdGVkJzogJ3NlbGVjdE5laWdoYm9yaG9vZHMnLA0KICAgIA0KICAgICdzaGFyZWRTdGF0ZS55ZWFyJzogJ3VwZGF0ZVllYXInLA0KICAgICdzaGFyZWRTdGF0ZS5zZWxlY3RlZCc6ICdzdHlsZU5laWdoYm9yaG9vZHMnLA0KICAgICdzaGFyZWRTdGF0ZS5oaWdobGlnaHQnOiAnc3R5bGVOZWlnaGJvcmhvb2RzJw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaW5pdE1hcDogZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCiAgICAgIF90aGlzLnByaXZhdGVTdGF0ZS5tYXAgPSBuZXcgbWFwYm94Z2wuTWFwKF90aGlzLnByaXZhdGVTdGF0ZS5tYXBPcHRpb25zKTsNCg0KICAgICAgbGV0IG1hcCA9IF90aGlzLnByaXZhdGVTdGF0ZS5tYXA7DQoJCSANCiAgICAgIC8vIGFkZCBuYXYgY29udHJvbA0KICAgICAgdmFyIG5hdiA9IG5ldyBtYXBib3hnbC5OYXZpZ2F0aW9uQ29udHJvbCgpOw0KICAgICAgbWFwLmFkZENvbnRyb2wobmF2LCAndG9wLXJpZ2h0Jyk7DQoNCgkgIC8vIFBpdGNoIGNvbnRyb2wNCiAgICBjbGFzcyBQaXRjaENvbnRyb2wgew0KICAgICAgb25BZGQobWFwKSB7DQogICAgICAgIHRoaXMuX21hcCA9IG1hcDsNCiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSAnbWFwYm94Z2wtY3RybCBtYXBib3hnbC1jdHJsLWdyb3VwJzsNCiAgICAgICAgY29udGFpbmVyLmlubmVySFRNTCA9ICc8YnV0dG9uIGNsYXNzPSJtYXBib3hnbC1jdHJsLWljb24gbWFwYm94Z2wtY3RybC1jdXN0b20tcGl0Y2giIHR5cGU9ImJ1dHRvbiI+PHNwYW4+M0Q8L3NwYW4+PC9idXR0b24+JzsNCiAgICAgICAgY29udGFpbmVyLm9uY2xpY2sgPSBmdW5jdGlvbigpew0KICAgICAgICAgIGNvbnN0IHBpdGNoID0gbWFwLmdldFBpdGNoKCk7DQogICAgICAgICAgY29uc3Qgem9vbSA9IG1hcC5nZXRab29tKCk7DQogICAgICAgICAgbGV0IG5leHRQaXRjaCA9IDA7DQogICAgICAgICAgaWYgKHBpdGNoIDw9IDUpIG5leHRQaXRjaCA9IDMwOw0KICAgICAgICAgIGlmICh6b29tIDwgMTAgJiYgcGl0Y2ggPCA1KSB7DQogICAgICAgICAgICBtYXAuZmx5VG8oew0KICAgICAgICAgICAgICBwaXRjaDogbmV4dFBpdGNoLA0KICAgICAgICAgICAgICAvL3pvb206IDgsDQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbWFwLmVhc2VUbyh7DQogICAgICAgICAgICAgIHBpdGNoOiBuZXh0UGl0Y2gNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfTsNCiAgICAgICAgbWFwLm9uKCdwaXRjaGVuZCcsIHRoaXMub25QaXRjaCk7DQogICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lcjsNCiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRhaW5lcjsNCiAgICAgIH0NCiAgICAgIG9uUGl0Y2ggPSAoKSA9PiB7DQogICAgICAgIGNvbnN0IHBpdGNoID0gdGhpcy5fbWFwLmdldFBpdGNoKCk7DQogICAgICAgIGNvbnN0IGlzM0RNb2RlID0gcGl0Y2ggPiA1Ow0KICAgICAgICB0aGlzLl9jb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJywgaXMzRE1vZGUpOw0KICAgICAgfQ0KICAgICAgb25SZW1vdmUoKSB7DQogICAgICAgIHRoaXMuX2NvbnRhaW5lci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMuX2NvbnRhaW5lcik7DQogICAgICAgIHRoaXMuX21hcC5vZmYoJ3BpdGNoZW5kJywgdGhpcy5vblBpdGNoKTsNCiAgICAgICAgdGhpcy5fbWFwID0gdW5kZWZpbmVkOw0KICAgICAgfQ0KICAgIH07DQogICAgbWFwLmFkZENvbnRyb2wobmV3IFBpdGNoQ29udHJvbCgpLCAndG9wLXJpZ2h0Jyk7DQoJICANCiAgICAgIC8vIGRpc2FibGUgbWFwIHJvdGF0aW9uIHVzaW5nIHJpZ2h0IGNsaWNrICsgZHJhZyBhbmQgdG91Y2gNCiAgICAgIGlmIChfdGhpcy5wcml2YXRlU3RhdGUucGl0Y2ggPT09IGZhbHNlKSB7DQogICAgICAgIC8vbWFwLmRyYWdSb3RhdGUuZGlzYWJsZSgpOw0KICAgICAgICBtYXAudG91Y2hab29tUm90YXRlLmRpc2FibGVSb3RhdGlvbigpOw0KICAgICAgfQ0KDQogICAgICAvLyBhZnRlciBtYXAgaW5pdGlhdGVkLCBncmFiIGdlb2dyYXBoeSBhbmQgaW50aWF0ZS9zdHlsZSBuZWlnaGJvcmhvb2RzDQogICAgICBtYXAub24oJ2xvYWQnLCBmdW5jdGlvbiAoKSB7DQogICAgICAgIF90aGlzLnByaXZhdGVTdGF0ZS5tYXBMb2FkZWQgPSB0cnVlOw0KICAgICAgICBfdGhpcy5wcml2YXRlU3RhdGUuZ2VvSlNPTiA9IGdlb2c7DQogICAgICAgIF90aGlzLmluaXROZWlnaGJvcmhvb2RzKCk7DQogICAgICAgIF90aGlzLnN0eWxlTmVpZ2hib3Job29kcygpOw0KICAgICAgICBfdGhpcy5pbml0TWFwRXZlbnRzKCk7DQoNCiAgICAgICAgaWYgKF90aGlzLnNoYXJlZFN0YXRlLnNlbGVjdGVkLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICBfdGhpcy56b29tTmVpZ2hib3Job29kcygpOw0KICAgICAgICB9DQogICAgICB9KTsNCg0KICAgIH0sDQogICAgaW5pdE1hcEV2ZW50czogZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IG1hcCA9IHRoaXMucHJpdmF0ZVN0YXRlLm1hcDsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICBsZXQgcG9wdXAgPSBuZXcgbWFwYm94Z2wuUG9wdXAoew0KICAgICAgICBjbG9zZUJ1dHRvbjogZmFsc2UsDQogICAgICAgIGNsb3NlT25DbGljazogZmFsc2UNCiAgICAgIH0pOw0KDQogICAgICBtYXAub24oJ21vdXNlbW92ZScsICduZWlnaGJvcmhvb2RzLWZpbGwtZXh0cnVkZScsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIG1hcC5nZXRDYW52YXMoKS5zdHlsZS5jdXJzb3IgPSAncG9pbnRlcic7DQogICAgICAgIGxldCBmZWF0dXJlID0gZS5mZWF0dXJlc1swXTsNCiAgICAgICAgDQogICAgICAgIHBvcHVwDQogICAgICAgICAgLnNldExuZ0xhdChtYXAudW5wcm9qZWN0KGUucG9pbnQpKQ0KICAgICAgICAgIC5zZXRIVE1MKA0KICAgICAgICAgICAgYDxkaXYgc3R5bGU9InRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAwOyBwYWRkaW5nOiAwOyI+DQoJCQlVcmJhbiBab25lOiAke2ZlYXR1cmUucHJvcGVydGllcy5TVUJaT05FX059PC9kaXY+CQkJDQoJCQk8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbjogMDsgcGFkZGluZzogMDsiPiBQbGFuIEFyZWE6ICR7ZmVhdHVyZS5wcm9wZXJ0aWVzLlBMTl9BUkVBX059PC9kaXY+DQoJCQk8ZGl2IHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbjogMDsgcGFkZGluZzogMDsiPiBQb3B1bGF0aW9uOiAke2ZlYXR1cmUucHJvcGVydGllcy5UT1RBTH08L2Rpdj5gDQogICAgICAgICAgKQ0KICAgICAgICAgIC5hZGRUbyhtYXApOw0KICAgICAgfSk7DQoNCiAgICAgIG1hcC5vbignbW91c2VsZWF2ZScsICduZWlnaGJvcmhvb2RzLWZpbGwtZXh0cnVkZScsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgbWFwLmdldENhbnZhcygpLnN0eWxlLmN1cnNvciA9ICcnOw0KICAgICAgICBwb3B1cC5yZW1vdmUoKTsNCiAgICAgIH0pOw0KDQogICAgICBtYXAub24oJ3JvdGF0ZScsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGlmIChtYXAuZ2V0UGl0Y2goKSA+PSAyMCkgew0KICAgICAgICAgIF90aGlzLnRvZ2dsZTNEKCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgX3RoaXMudG9nZ2xlM0QoKTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICB0b2dnbGUzRDogZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCiAgICAgIGxldCBtYXAgPSBfdGhpcy5wcml2YXRlU3RhdGUubWFwOw0KICAgICAgbGV0IHBpdGNoZWQ7DQoNCiAgICAgIG1hcC5nZXRQaXRjaCgpID49IDIwID8gKHBpdGNoZWQgPSB0cnVlKSA6IChwaXRjaGVkID0gZmFsc2UpOw0KDQogICAgICBpZiAocGl0Y2hlZCkgew0KICAgICAgICBtYXAuc2V0TGF5b3V0UHJvcGVydHkoJ25laWdoYm9yaG9vZHMnLCAndmlzaWJpbGl0eScsICdub25lJyk7DQogICAgICAgIG1hcC5tb3ZlTGF5ZXIoJ25laWdoYm9yaG9vZHMtZmlsbC1leHRydWRlJyk7DQogICAgICAgIG1hcC5zZXRQYWludFByb3BlcnR5KA0KICAgICAgICAgICduZWlnaGJvcmhvb2RzLWZpbGwtZXh0cnVkZScsDQogICAgICAgICAgJ2ZpbGwtZXh0cnVzaW9uLWhlaWdodCcsDQogICAgICAgICAgX3RoaXMuZ2V0SGVpZ2h0KCkNCiAgICAgICAgKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIG1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnbmVpZ2hib3Job29kcycsICd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTsNCiAgICAgICAgbWFwLm1vdmVMYXllcignbmVpZ2hib3Job29kcy1maWxsLWV4dHJ1ZGUnLCAnYnVpbGRpbmcnKTsNCiAgICAgICAgbWFwLnNldFBhaW50UHJvcGVydHkoDQogICAgICAgICAgJ25laWdoYm9yaG9vZHMtZmlsbC1leHRydWRlJywNCiAgICAgICAgICAnZmlsbC1leHRydXNpb24taGVpZ2h0JywNCiAgICAgICAgICAwDQogICAgICAgICk7DQogICAgICB9DQogICAgfSwNCiAgICBpbml0TmVpZ2hib3Job29kczogZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IG1hcCA9IHRoaXMucHJpdmF0ZVN0YXRlLm1hcDsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICBsZXQgZ2VvSlNPTiA9IF90aGlzLnByaXZhdGVTdGF0ZS5nZW9KU09OOw0KDQogICAgICBtYXAuYWRkU291cmNlKCduZWlnaGJvcmhvb2RzJywgew0KICAgICAgICB0eXBlOiAnZ2VvanNvbicsDQogICAgICAgIGRhdGE6IGdlb0pTT04NCiAgICAgIH0pOw0KDQogICAgICAvLyBuZWlnaGJvcmhvb2QgYm91bmRhcmllcw0KICAgICAgbWFwLmFkZExheWVyKHsNCiAgICAgICAgICBpZDogJ25laWdoYm9yaG9vZHMnLA0KICAgICAgICAgIHR5cGU6ICdsaW5lJywNCiAgICAgICAgICBzb3VyY2U6ICduZWlnaGJvcmhvb2RzJywNCiAgICAgICAgICBsYXlvdXQ6IHt9LA0KICAgICAgICAgIHBhaW50OiB7fQ0KICAgICAgICB9LA0KICAgICAgICAncGxhY2Vfb3RoZXInDQogICAgICApOw0KDQogICAgICBtYXAuYWRkTGF5ZXIoew0KICAgICAgICAgIGlkOiAnbmVpZ2hib3Job29kcy1maWxsLWV4dHJ1ZGUnLA0KICAgICAgICAgIHR5cGU6ICdmaWxsLWV4dHJ1c2lvbicsDQogICAgICAgICAgc291cmNlOiAnbmVpZ2hib3Job29kcycsDQogICAgICAgICAgLy8nZmlsdGVyJzogWychPScsICdjaG9yb3BsZXRoJywgJ251bGwnXSwNCiAgICAgICAgICBwYWludDogew0KICAgICAgICAgICAgJ2ZpbGwtZXh0cnVzaW9uLW9wYWNpdHknOiAwLjcNCiAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgICdidWlsZGluZycNCiAgICAgICk7DQoJICANCiAgICAgIC8vIG1hcmtlcnMgbGF5ZXINCiAgICAgIG1hcC5hZGRTb3VyY2UoJ21hcmtlcnMnLCB7DQogICAgICAgIHR5cGU6ICdnZW9qc29uJywNCiAgICAgICAgZGF0YTogdmlyb3VzZ2VvZw0KICAgICAgfSk7DQogICAgICBtYXAuYWRkTGF5ZXIoew0KICAgICAgICBpZDogJ21hcmtlcnMnLA0KICAgICAgICB0eXBlOiAnY2lyY2xlJywNCiAgICAgICAgc291cmNlOiAnbWFya2VycycsDQogICAgICAgIC8qIGxheW91dDogew0KICAgICAgICAgICdpY29uLWltYWdlJzogJ2NpcmNsZS0xMScsDQogICAgICAgICAgJ2ljb24tc2l6ZSc6IDEuMCwNCgkJICANCiAgICAgICAgfSAqLw0KCQlwYWludDogew0KCQknY2lyY2xlLXJhZGl1cyc6IDEwLA0KCQknY2lyY2xlLWNvbG9yJzogJyNmZjAwMDAnDQoJCX0NCiAgICAgIH0pOw0KCSAgDQoNCgkgIAltYXAuc2V0UGl0Y2goMzApDQoJCW1hcC5zZXRMYXlvdXRQcm9wZXJ0eSgnbmVpZ2hib3Job29kcycsICd2aXNpYmlsaXR5JywgJ25vbmUnKTsNCiAgICAgICAgbWFwLm1vdmVMYXllcignbmVpZ2hib3Job29kcy1maWxsLWV4dHJ1ZGUnKTsNCiAgICAgICAgbWFwLnNldFBhaW50UHJvcGVydHkoDQogICAgICAgICAgJ25laWdoYm9yaG9vZHMtZmlsbC1leHRydWRlJywNCiAgICAgICAgICAnZmlsbC1leHRydXNpb24taGVpZ2h0JywNCiAgICAgICAgICBfdGhpcy5nZXRIZWlnaHQoKQ0KICAgICAgICApOw0KICAgIH0sDQogICAgc2VsZWN0TmVpZ2hib3Job29kczogZnVuY3Rpb24gKCkgew0KICAgICAgaWYgKHRoaXMucHJpdmF0ZVN0YXRlLm1hcExvYWRlZCA9PT0gdHJ1ZSkgew0KICAgICAgICBsZXQgbWFwID0gdGhpcy5wcml2YXRlU3RhdGUubWFwOw0KICAgICAgICBsZXQgc2VsZWN0ZWQgPSB0aGlzLnNoYXJlZFN0YXRlLnNlbGVjdGVkOw0KICAgICAgICBsZXQgZmlsdGVyOw0KDQogICAgICAgIGlmIChzZWxlY3RlZC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgZmlsdGVyID0gWydpbicsICdpZCddOw0KICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWQubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGZpbHRlci5wdXNoKHNlbGVjdGVkW2ldKTsNCiAgICAgICAgICB9DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgZmlsdGVyID0gWydpbicsICdpZCcsICctOTk5OTk5J107DQogICAgICAgIH0NCg0KICAgICAgICAvLyBwdXNoIHNlbGVjdGVkIHN0YXRlDQogICAgICAgIGxldCBsaW5rTWV0cmljID0gJyc7DQogICAgICAgIGlmIChnZXRVUkxQYXJhbWV0ZXIoJ20nKSkgew0KICAgICAgICAgIGxpbmtNZXRyaWMgPSBnZXRVUkxQYXJhbWV0ZXIoJ20nKTsNCiAgICAgICAgfQ0KDQogICAgICAgIG1hcC5zZXRGaWx0ZXIoJ25laWdoYm9yaG9vZHMtbGluZS1zZWxlY3RlZCcsIGZpbHRlcik7DQogICAgICAgIG1hcC5zZXRGaWx0ZXIoJ25laWdoYm9yaG9vZHMtZmlsbC1zZWxlY3RlZCcsIGZpbHRlcik7DQogICAgICB9DQogICAgfSwNCiAgICBzdHlsZU5laWdoYm9yaG9vZHM6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGxldCBtYXAgPSB0aGlzLnByaXZhdGVTdGF0ZS5tYXA7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KDQogICAgICBtYXAuc2V0UGFpbnRQcm9wZXJ0eSgNCiAgICAgICAgJ25laWdoYm9yaG9vZHMtZmlsbC1leHRydWRlJywNCiAgICAgICAgJ2ZpbGwtZXh0cnVzaW9uLWNvbG9yJywNCiAgICAgICAgX3RoaXMuZ2V0Q29sb3JzKCkNCiAgICAgICk7DQogICAgICBtYXAuc2V0UGFpbnRQcm9wZXJ0eSgNCiAgICAgICAgJ25laWdoYm9yaG9vZHMnLA0KICAgICAgICAnbGluZS1jb2xvcicsDQogICAgICAgIF90aGlzLmdldE91dGxpbmVDb2xvcigpDQogICAgICApOw0KICAgICAgbWFwLnNldFBhaW50UHJvcGVydHkoDQogICAgICAgICduZWlnaGJvcmhvb2RzJywNCiAgICAgICAgJ2xpbmUtd2lkdGgnLA0KICAgICAgICBfdGhpcy5nZXRPdXRsaW5lV2lkdGgoKQ0KICAgICAgKTsNCgkgIA0KICAgICAgaWYgKF90aGlzLnByaXZhdGVTdGF0ZS5pc1BpdGNoZWQzRCkgew0KICAgICAgICBtYXAuc2V0UGFpbnRQcm9wZXJ0eSgNCiAgICAgICAgICAnbmVpZ2hib3Job29kcy1maWxsLWV4dHJ1ZGUnLA0KICAgICAgICAgICdmaWxsLWV4dHJ1c2lvbi1oZWlnaHQnLA0KICAgICAgICAgIF90aGlzLmdldEhlaWdodCgpDQogICAgICAgICk7DQogICAgICB9DQogICAgfSwNCiAgICB1cGRhdGVDaG9yb3BsZXRoOiBmdW5jdGlvbiAoKSB7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgaWYgKHRoaXMucHJpdmF0ZVN0YXRlLm1hcExvYWRlZCkgew0KICAgICAgICB0aGlzLnN0eWxlTmVpZ2hib3Job29kcygpOw0KICAgICAgfQ0KICAgIH0sDQogICAgdXBkYXRlQnJlYWtzOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLnByaXZhdGVTdGF0ZS5tZXRyaWNJZCA9IHRoaXMuc2hhcmVkU3RhdGUubWV0cmljSWQ7DQogICAgICB0aGlzLnVwZGF0ZUNob3JvcGxldGgoKTsNCiAgICB9LA0KICAgIHVwZGF0ZVllYXI6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGlmICh0aGlzLnNoYXJlZFN0YXRlLm1ldHJpY0lkID09PSB0aGlzLnByaXZhdGVTdGF0ZS5tZXRyaWNJZCkgew0KICAgICAgICB0aGlzLnVwZGF0ZUNob3JvcGxldGgoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGdlb0pTT05NZXJnZTogZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCiAgICAgIGxldCBnZW9PYmogPSBnZW9qc29uRGF0YU1lcmdlKA0KICAgICAgICBfdGhpcy5wcml2YXRlU3RhdGUuZ2VvSlNPTiwNCiAgICAgICAgX3RoaXMuc2hhcmVkU3RhdGUubWV0cmljLmRhdGEubWFwLA0KICAgICAgICBfdGhpcy5zaGFyZWRTdGF0ZS55ZWFyDQogICAgICApOw0KICAgICAgcmV0dXJuIGdlb09iajsNCiAgICB9LA0KICAgIGdldEZ1bGxCb3VuZHM6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGxldCBib3VuZHMgPSBuZXcgbWFwYm94Z2wuTG5nTGF0Qm91bmRzKCk7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KDQogICAgICB0aGlzLnByaXZhdGVTdGF0ZS5nZW9KU09OLmZlYXR1cmVzLmZvckVhY2goZnVuY3Rpb24gKGZlYXR1cmUpIHsNCiAgICAgICAgZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChjb29yZCkgew0KICAgICAgICAgIGNvb3JkLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7DQogICAgICAgICAgICBib3VuZHMuZXh0ZW5kKGVsKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCg0KICAgICAgcmV0dXJuIGJvdW5kczsNCiAgICB9LA0KICAgIHpvb21OZWlnaGJvcmhvb2RzOiBmdW5jdGlvbiAoKSB7DQogICAgICBsZXQgYm91bmRzID0gbmV3IG1hcGJveGdsLkxuZ0xhdEJvdW5kcygpOw0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCg0KICAgICAgdGhpcy5wcml2YXRlU3RhdGUuZ2VvSlNPTi5mZWF0dXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChmZWF0dXJlKSB7DQogICAgICAgIGlmIChfdGhpcy5zaGFyZWRTdGF0ZS5zZWxlY3RlZC5pbmRleE9mKGZlYXR1cmUucHJvcGVydGllcy5pZCkgIT09IC0xKSB7DQogICAgICAgICAgZmVhdHVyZS5nZW9tZXRyeS5jb29yZGluYXRlcy5mb3JFYWNoKGZ1bmN0aW9uIChjb29yZCkgew0KICAgICAgICAgICAgY29vcmQuZm9yRWFjaChmdW5jdGlvbiAoZWwpIHsNCiAgICAgICAgICAgICAgYm91bmRzLmV4dGVuZChlbCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQoNCiAgICAgIHRoaXMucHJpdmF0ZVN0YXRlLm1hcC5maXRCb3VuZHMoYm91bmRzLCB7DQogICAgICAgIHBhZGRpbmc6IDEwMA0KICAgICAgfSk7DQogICAgfSwNCiAgICBnZXRPdXRsaW5lQ29sb3I6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGNvbnN0IHN0b3BzID0gW107DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KDQogICAgICBfdGhpcy5zaGFyZWRTdGF0ZS5zZWxlY3RlZC5mb3JFYWNoKGlkID0+IHsNCiAgICAgICAgc3RvcHMucHVzaChbaWQsICcjYmEwMGU0J10pOw0KICAgICAgfSk7DQoNCiAgICAgIGxldCBvdXRsaW5lID0gew0KICAgICAgICBwcm9wZXJ0eTogJ09CSkVDVElEJywNCiAgICAgICAgZGVmYXVsdDogJ3JnYmEoMCwwLDAsMSknLA0KICAgICAgICB0eXBlOiAnY2F0ZWdvcmljYWwnLA0KICAgICAgICBzdG9wczogc3RvcHMNCiAgICAgIH07DQoNCiAgICAgIGlmIChzdG9wcy5sZW5ndGggPiAwKSB7DQogICAgICAgIHJldHVybiBvdXRsaW5lOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIG91dGxpbmUuZGVmYXVsdDsNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldE91dGxpbmVXaWR0aDogZnVuY3Rpb24gKCkgew0KICAgICAgY29uc3Qgc3RvcHMgPSBbXTsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQoNCiAgICAgIF90aGlzLnNoYXJlZFN0YXRlLnNlbGVjdGVkLmZvckVhY2goaWQgPT4gew0KICAgICAgICBzdG9wcy5wdXNoKFtpZCwgNF0pOw0KICAgICAgfSk7DQoNCiAgICAgIGxldCBvdXRsaW5lU2l6ZSA9IHsNCiAgICAgICAgcHJvcGVydHk6ICdPQkpFQ1RJRCcsDQogICAgICAgIGRlZmF1bHQ6IDAuNCwNCiAgICAgICAgdHlwZTogJ2NhdGVnb3JpY2FsJywNCiAgICAgICAgc3RvcHM6IHN0b3BzDQogICAgICB9Ow0KDQogICAgICBpZiAoc3RvcHMubGVuZ3RoID4gMCkgew0KICAgICAgICByZXR1cm4gb3V0bGluZVNpemU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gb3V0bGluZVNpemUuZGVmYXVsdDsNCiAgICAgIH0NCg0KICAgICAgcmV0dXJuIHN0b3BzOw0KICAgIH0sDQogICAgZ2V0Q29sb3JzOiBmdW5jdGlvbiAoKSB7DQogICAgICBjb25zdCBzdG9wcyA9IFtdOw0KICAgICAgbGV0IF90aGlzID0gdGhpczsNCgkgIA0KCSAgbGV0IGZlYXR1cmUgPSBfdGhpcy5wcml2YXRlU3RhdGUuZ2VvSlNPTi5mZWF0dXJlczsNCiAgICAgIGxldCBpZCA9IDE7ICANCiAgICAgIGxldCBkYXRhID0gZmVhdHVyZTsNCgkgIA0KICAgICAgbGV0IGJyZWFrcyA9IFszMTI1LDYyNTAsMTI1MDAsMjUwMDAsNTAwMDAsMjAwMDAwXTsNCgkgIF90aGlzLnNoYXJlZFN0YXRlLmJyZWFrcyA9IGJyZWFrczsNCiAgICAgIGxldCBjb2xvcnMgPSB0aGlzLnNoYXJlZFN0YXRlLmNvbG9yczsNCg0KICAgICAgbGV0IGNvbG9yID0gZnVuY3Rpb24gKHZhbCkgew0KICAgICAgICBpZiAodmFsIDw9IGJyZWFrc1sxXSkgew0KICAgICAgICAgIHJldHVybiBjb2xvcnNbMF07DQogICAgICAgIH0gZWxzZSBpZiAodmFsIDw9IGJyZWFrc1syXSkgew0KICAgICAgICAgIHJldHVybiBjb2xvcnNbMV07DQogICAgICAgIH0gZWxzZSBpZiAodmFsIDw9IGJyZWFrc1szXSkgew0KICAgICAgICAgIHJldHVybiBjb2xvcnNbMl07DQogICAgICAgIH0gZWxzZSBpZiAodmFsIDw9IGJyZWFrc1s0XSkgew0KICAgICAgICAgIHJldHVybiBjb2xvcnNbM107DQogICAgICAgIH0gZWxzZSBpZiAodmFsIDw9IGJyZWFrc1s1XSkgew0KICAgICAgICAgIHJldHVybiBjb2xvcnNbNF07DQogICAgICAgIH0NCiAgICAgIH07DQoNCiAgICBPYmplY3Qua2V5cyhkYXRhKS5mb3JFYWNoKGlkID0+IHsNCiAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IF90aGlzLnNoYXJlZFN0YXRlLmhpZ2hsaWdodC5sZW5ndGg7DQogICAgICAgICAgICAgIA0KCQkJIGlmICh2YWx1ZSAhPT0gMCAmJiBpZCA8IHZhbHVlKSB7CQkJIA0KCQkJICAgIA0KCQkJCXN0b3BzLnB1c2goW051bWJlcihfdGhpcy5zaGFyZWRTdGF0ZS5oaWdobGlnaHRbaWRdKSwgJyNGN0U1NUInXSk7DQoNCiAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09IDAgKSB7DQogICAgICAgICAgICAgICBzdG9wcy5wdXNoKFtkYXRhW2lkXS5wcm9wZXJ0aWVzLk9CSkVDVElELCBjb2xvcihkYXRhW2lkXS5wcm9wZXJ0aWVzLlRPVEFMKV0pOw0KICAgICAgICAgICAgIH0NCgkJCSANCgkJCSANCiAgICAgICAgICAgfSk7DQoJCSAgIA0KCSAgDQogICAgICBsZXQgZmlsbENvbG9yID0gew0KICAgICAgICBwcm9wZXJ0eTogJ09CSkVDVElEJywNCiAgICAgICAgZGVmYXVsdDogJ3JnYigyNDIsMjQzLDI0MCknLA0KICAgICAgICB0eXBlOiAnY2F0ZWdvcmljYWwnLA0KICAgICAgICBzdG9wczogc3RvcHMNCiAgICAgIH07DQoNCiAgICAgIHJldHVybiBmaWxsQ29sb3I7DQogICAgfSwNCiAgICBnZXRIZWlnaHQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICBjb25zdCBzdG9wcyA9IFtdOw0KICAgICAgDQoJICBsZXQgZmVhdHVyZSA9IF90aGlzLnByaXZhdGVTdGF0ZS5nZW9KU09OLmZlYXR1cmVzOw0KICAgICAgbGV0IGlkID0gMTsgIA0KICAgICAgbGV0IGRhdGEgPSBmZWF0dXJlOw0KCSAgbGV0IGhicmVha3MgPSBbMzEyNSw2MjUwLDEyNTAwLDI1MDAwLDUwMDAwLDIwMDAwMF07DQoJICBfdGhpcy5zaGFyZWRTdGF0ZS5icmVha3MgPSBoYnJlYWtzOw0KICAgICAgbGV0IGhlaWdodEFkanVzdCA9IHNjYWxlTGluZWFyKCkNCiAgICAgICAgLmRvbWFpbihbDQogICAgICAgICAgaGJyZWFrcywNCiAgICAgICAgICBoYnJlYWtzW2hicmVha3MubGVuZ3RoIC0gMV0NCiAgICAgICAgXSkNCiAgICAgICAgLnJhbmdlKFswLCAyMDAwMDBdKTsNCg0KICAgICAgT2JqZWN0LmtleXMoZGF0YSkuZm9yRWFjaChpZCA9PiB7DQogICAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtpZF0ucHJvcGVydGllcy5UT1RBTDsNCiAgICAgICAgaWYgKHZhbHVlICE9PSBudWxsKSB7DQogICAgICAgICAgc3RvcHMucHVzaChbZGF0YVtpZF0ucHJvcGVydGllcy5PQkpFQ1RJRCwgdmFsdWUvMTAwXSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KCSAgDQogICAgICBsZXQgaGVpZ2h0ID0gew0KICAgICAgICBwcm9wZXJ0eTogJ09CSkVDVElEJywNCiAgICAgICAgZGVmYXVsdDogMCwNCiAgICAgICAgdHlwZTogJ2NhdGVnb3JpY2FsJywNCiAgICAgICAgc3RvcHM6IHN0b3BzDQogICAgICB9Ow0KDQogICAgICByZXR1cm4gaGVpZ2h0Ow0KICAgIH0NCiAgfSwNCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgew0KICAgIHRoaXMuaW5pdE1hcCgpOw0KICB9DQp9Ow0K"},{"version":3,"sources":["map.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;;AAGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"map.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div class=\"\" style=\"position: relative; width: 100%; height: 100%\">\r\n    <div id=\"map\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport mapboxgl from 'mapbox-gl';\r\nimport geojsonDataMerge from '../js/geojsondatamerge';\r\nimport {\r\n  prettyNumber\r\n} from '../js/number_format';\r\nimport getURLParameter from '../js/geturlparams';\r\nimport {\r\n  scaleLinear\r\n} from 'd3-scale';\r\nimport geog from '../../data/geography.geojson.json';\r\nimport virousgeog from '../../data/config/COVID.geojson.json';\r\n\r\nexport default {\r\n  name: 'sc-map',\r\n  watch: {\r\n    'sharedState.selected': 'selectNeighborhoods',\r\n    \r\n    'sharedState.year': 'updateYear',\r\n    'sharedState.selected': 'styleNeighborhoods',\r\n    'sharedState.highlight': 'styleNeighborhoods'\r\n  },\r\n  methods: {\r\n    initMap: function () {\r\n      let _this = this;\r\n      _this.privateState.map = new mapboxgl.Map(_this.privateState.mapOptions);\r\n\r\n      let map = _this.privateState.map;\r\n\t\t \r\n      // add nav control\r\n      var nav = new mapboxgl.NavigationControl();\r\n      map.addControl(nav, 'top-right');\r\n\r\n\t  // Pitch control\r\n    class PitchControl {\r\n      onAdd(map) {\r\n        this._map = map;\r\n        const container = document.createElement('div');\r\n        container.className = 'mapboxgl-ctrl mapboxgl-ctrl-group';\r\n        container.innerHTML = '<button class=\"mapboxgl-ctrl-icon mapboxgl-ctrl-custom-pitch\" type=\"button\"><span>3D</span></button>';\r\n        container.onclick = function(){\r\n          const pitch = map.getPitch();\r\n          const zoom = map.getZoom();\r\n          let nextPitch = 0;\r\n          if (pitch <= 5) nextPitch = 30;\r\n          if (zoom < 10 && pitch < 5) {\r\n            map.flyTo({\r\n              pitch: nextPitch,\r\n              //zoom: 8,\r\n            });\r\n          } else {\r\n            map.easeTo({\r\n              pitch: nextPitch\r\n            });\r\n          }\r\n        };\r\n        map.on('pitchend', this.onPitch);\r\n        this._container = container;\r\n        return this._container;\r\n      }\r\n      onPitch = () => {\r\n        const pitch = this._map.getPitch();\r\n        const is3DMode = pitch > 5;\r\n        this._container.classList.toggle('active', is3DMode);\r\n      }\r\n      onRemove() {\r\n        this._container.parentNode.removeChild(this._container);\r\n        this._map.off('pitchend', this.onPitch);\r\n        this._map = undefined;\r\n      }\r\n    };\r\n    map.addControl(new PitchControl(), 'top-right');\r\n\t  \r\n      // disable map rotation using right click + drag and touch\r\n      if (_this.privateState.pitch === false) {\r\n        //map.dragRotate.disable();\r\n        map.touchZoomRotate.disableRotation();\r\n      }\r\n\r\n      // after map initiated, grab geography and intiate/style neighborhoods\r\n      map.on('load', function () {\r\n        _this.privateState.mapLoaded = true;\r\n        _this.privateState.geoJSON = geog;\r\n        _this.initNeighborhoods();\r\n        _this.styleNeighborhoods();\r\n        _this.initMapEvents();\r\n\r\n        if (_this.sharedState.selected.length > 0) {\r\n          _this.zoomNeighborhoods();\r\n        }\r\n      });\r\n\r\n    },\r\n    initMapEvents: function () {\r\n      let map = this.privateState.map;\r\n      let _this = this;\r\n      let popup = new mapboxgl.Popup({\r\n        closeButton: false,\r\n        closeOnClick: false\r\n      });\r\n\r\n      map.on('mousemove', 'neighborhoods-fill-extrude', function (e) {\r\n        map.getCanvas().style.cursor = 'pointer';\r\n        let feature = e.features[0];\r\n        \r\n        popup\r\n          .setLngLat(map.unproject(e.point))\r\n          .setHTML(\r\n            `<div style=\"text-align: center; margin: 0; padding: 0;\">\r\n\t\t\tUrban Zone: ${feature.properties.SUBZONE_N}</div>\t\t\t\r\n\t\t\t<div style=\"text-align: center; margin: 0; padding: 0;\"> Plan Area: ${feature.properties.PLN_AREA_N}</div>\r\n\t\t\t<div style=\"text-align: center; margin: 0; padding: 0;\"> Population: ${feature.properties.TOTAL}</div>`\r\n          )\r\n          .addTo(map);\r\n      });\r\n\r\n      map.on('mouseleave', 'neighborhoods-fill-extrude', function () {\r\n        map.getCanvas().style.cursor = '';\r\n        popup.remove();\r\n      });\r\n\r\n      map.on('rotate', function (e) {\r\n        if (map.getPitch() >= 20) {\r\n          _this.toggle3D();\r\n        } else {\r\n          _this.toggle3D();\r\n        }\r\n      });\r\n    },\r\n    toggle3D: function () {\r\n      let _this = this;\r\n      let map = _this.privateState.map;\r\n      let pitched;\r\n\r\n      map.getPitch() >= 20 ? (pitched = true) : (pitched = false);\r\n\r\n      if (pitched) {\r\n        map.setLayoutProperty('neighborhoods', 'visibility', 'none');\r\n        map.moveLayer('neighborhoods-fill-extrude');\r\n        map.setPaintProperty(\r\n          'neighborhoods-fill-extrude',\r\n          'fill-extrusion-height',\r\n          _this.getHeight()\r\n        );\r\n      } else {\r\n        map.setLayoutProperty('neighborhoods', 'visibility', 'visible');\r\n        map.moveLayer('neighborhoods-fill-extrude', 'building');\r\n        map.setPaintProperty(\r\n          'neighborhoods-fill-extrude',\r\n          'fill-extrusion-height',\r\n          0\r\n        );\r\n      }\r\n    },\r\n    initNeighborhoods: function () {\r\n      let map = this.privateState.map;\r\n      let _this = this;\r\n      let geoJSON = _this.privateState.geoJSON;\r\n\r\n      map.addSource('neighborhoods', {\r\n        type: 'geojson',\r\n        data: geoJSON\r\n      });\r\n\r\n      // neighborhood boundaries\r\n      map.addLayer({\r\n          id: 'neighborhoods',\r\n          type: 'line',\r\n          source: 'neighborhoods',\r\n          layout: {},\r\n          paint: {}\r\n        },\r\n        'place_other'\r\n      );\r\n\r\n      map.addLayer({\r\n          id: 'neighborhoods-fill-extrude',\r\n          type: 'fill-extrusion',\r\n          source: 'neighborhoods',\r\n          //'filter': ['!=', 'choropleth', 'null'],\r\n          paint: {\r\n            'fill-extrusion-opacity': 0.7\r\n          }\r\n        },\r\n        'building'\r\n      );\r\n\t  \r\n      // markers layer\r\n      map.addSource('markers', {\r\n        type: 'geojson',\r\n        data: virousgeog\r\n      });\r\n      map.addLayer({\r\n        id: 'markers',\r\n        type: 'circle',\r\n        source: 'markers',\r\n        /* layout: {\r\n          'icon-image': 'circle-11',\r\n          'icon-size': 1.0,\r\n\t\t  \r\n        } */\r\n\t\tpaint: {\r\n\t\t'circle-radius': 10,\r\n\t\t'circle-color': '#ff0000'\r\n\t\t}\r\n      });\r\n\t  \r\n\r\n\t  \tmap.setPitch(30)\r\n\t\tmap.setLayoutProperty('neighborhoods', 'visibility', 'none');\r\n        map.moveLayer('neighborhoods-fill-extrude');\r\n        map.setPaintProperty(\r\n          'neighborhoods-fill-extrude',\r\n          'fill-extrusion-height',\r\n          _this.getHeight()\r\n        );\r\n    },\r\n    selectNeighborhoods: function () {\r\n      if (this.privateState.mapLoaded === true) {\r\n        let map = this.privateState.map;\r\n        let selected = this.sharedState.selected;\r\n        let filter;\r\n\r\n        if (selected.length > 0) {\r\n          filter = ['in', 'id'];\r\n          for (let i = 0; i < selected.length; i++) {\r\n            filter.push(selected[i]);\r\n          }\r\n        } else {\r\n          filter = ['in', 'id', '-999999'];\r\n        }\r\n\r\n        // push selected state\r\n        let linkMetric = '';\r\n        if (getURLParameter('m')) {\r\n          linkMetric = getURLParameter('m');\r\n        }\r\n\r\n        map.setFilter('neighborhoods-line-selected', filter);\r\n        map.setFilter('neighborhoods-fill-selected', filter);\r\n      }\r\n    },\r\n    styleNeighborhoods: function () {\r\n      let map = this.privateState.map;\r\n      let _this = this;\r\n\r\n      map.setPaintProperty(\r\n        'neighborhoods-fill-extrude',\r\n        'fill-extrusion-color',\r\n        _this.getColors()\r\n      );\r\n      map.setPaintProperty(\r\n        'neighborhoods',\r\n        'line-color',\r\n        _this.getOutlineColor()\r\n      );\r\n      map.setPaintProperty(\r\n        'neighborhoods',\r\n        'line-width',\r\n        _this.getOutlineWidth()\r\n      );\r\n\t  \r\n      if (_this.privateState.isPitched3D) {\r\n        map.setPaintProperty(\r\n          'neighborhoods-fill-extrude',\r\n          'fill-extrusion-height',\r\n          _this.getHeight()\r\n        );\r\n      }\r\n    },\r\n    updateChoropleth: function () {\r\n      let _this = this;\r\n      if (this.privateState.mapLoaded) {\r\n        this.styleNeighborhoods();\r\n      }\r\n    },\r\n    updateBreaks: function () {\r\n      this.privateState.metricId = this.sharedState.metricId;\r\n      this.updateChoropleth();\r\n    },\r\n    updateYear: function () {\r\n      if (this.sharedState.metricId === this.privateState.metricId) {\r\n        this.updateChoropleth();\r\n      }\r\n    },\r\n    geoJSONMerge: function () {\r\n      let _this = this;\r\n      let geoObj = geojsonDataMerge(\r\n        _this.privateState.geoJSON,\r\n        _this.sharedState.metric.data.map,\r\n        _this.sharedState.year\r\n      );\r\n      return geoObj;\r\n    },\r\n    getFullBounds: function () {\r\n      let bounds = new mapboxgl.LngLatBounds();\r\n      let _this = this;\r\n\r\n      this.privateState.geoJSON.features.forEach(function (feature) {\r\n        feature.geometry.coordinates.forEach(function (coord) {\r\n          coord.forEach(function (el) {\r\n            bounds.extend(el);\r\n          });\r\n        });\r\n      });\r\n\r\n      return bounds;\r\n    },\r\n    zoomNeighborhoods: function () {\r\n      let bounds = new mapboxgl.LngLatBounds();\r\n      let _this = this;\r\n\r\n      this.privateState.geoJSON.features.forEach(function (feature) {\r\n        if (_this.sharedState.selected.indexOf(feature.properties.id) !== -1) {\r\n          feature.geometry.coordinates.forEach(function (coord) {\r\n            coord.forEach(function (el) {\r\n              bounds.extend(el);\r\n            });\r\n          });\r\n        }\r\n      });\r\n\r\n      this.privateState.map.fitBounds(bounds, {\r\n        padding: 100\r\n      });\r\n    },\r\n    getOutlineColor: function () {\r\n      const stops = [];\r\n      let _this = this;\r\n\r\n      _this.sharedState.selected.forEach(id => {\r\n        stops.push([id, '#ba00e4']);\r\n      });\r\n\r\n      let outline = {\r\n        property: 'OBJECTID',\r\n        default: 'rgba(0,0,0,1)',\r\n        type: 'categorical',\r\n        stops: stops\r\n      };\r\n\r\n      if (stops.length > 0) {\r\n        return outline;\r\n      } else {\r\n        return outline.default;\r\n      }\r\n    },\r\n    getOutlineWidth: function () {\r\n      const stops = [];\r\n      let _this = this;\r\n\r\n      _this.sharedState.selected.forEach(id => {\r\n        stops.push([id, 4]);\r\n      });\r\n\r\n      let outlineSize = {\r\n        property: 'OBJECTID',\r\n        default: 0.4,\r\n        type: 'categorical',\r\n        stops: stops\r\n      };\r\n\r\n      if (stops.length > 0) {\r\n        return outlineSize;\r\n      } else {\r\n        return outlineSize.default;\r\n      }\r\n\r\n      return stops;\r\n    },\r\n    getColors: function () {\r\n      const stops = [];\r\n      let _this = this;\r\n\t  \r\n\t  let feature = _this.privateState.geoJSON.features;\r\n      let id = 1;  \r\n      let data = feature;\r\n\t  \r\n      let breaks = [3125,6250,12500,25000,50000,200000];\r\n\t  _this.sharedState.breaks = breaks;\r\n      let colors = this.sharedState.colors;\r\n\r\n      let color = function (val) {\r\n        if (val <= breaks[1]) {\r\n          return colors[0];\r\n        } else if (val <= breaks[2]) {\r\n          return colors[1];\r\n        } else if (val <= breaks[3]) {\r\n          return colors[2];\r\n        } else if (val <= breaks[4]) {\r\n          return colors[3];\r\n        } else if (val <= breaks[5]) {\r\n          return colors[4];\r\n        }\r\n      };\r\n\r\n    Object.keys(data).forEach(id => {\r\n             const value = _this.sharedState.highlight.length;\r\n              \r\n\t\t\t if (value !== 0 && id < value) {\t\t\t \r\n\t\t\t    \r\n\t\t\t\tstops.push([Number(_this.sharedState.highlight[id]), '#F7E55B']);\r\n\r\n             } else if (value == 0 ) {\r\n               stops.push([data[id].properties.OBJECTID, color(data[id].properties.TOTAL)]);\r\n             }\r\n\t\t\t \r\n\t\t\t \r\n           });\r\n\t\t   \r\n\t  \r\n      let fillColor = {\r\n        property: 'OBJECTID',\r\n        default: 'rgb(242,243,240)',\r\n        type: 'categorical',\r\n        stops: stops\r\n      };\r\n\r\n      return fillColor;\r\n    },\r\n    getHeight: function () {\r\n      let _this = this;\r\n      const stops = [];\r\n      \r\n\t  let feature = _this.privateState.geoJSON.features;\r\n      let id = 1;  \r\n      let data = feature;\r\n\t  let hbreaks = [3125,6250,12500,25000,50000,200000];\r\n\t  _this.sharedState.breaks = hbreaks;\r\n      let heightAdjust = scaleLinear()\r\n        .domain([\r\n          hbreaks,\r\n          hbreaks[hbreaks.length - 1]\r\n        ])\r\n        .range([0, 200000]);\r\n\r\n      Object.keys(data).forEach(id => {\r\n        const value = data[id].properties.TOTAL;\r\n        if (value !== null) {\r\n          stops.push([data[id].properties.OBJECTID, value/100]);\r\n        }\r\n      });\r\n\t  \r\n      let height = {\r\n        property: 'OBJECTID',\r\n        default: 0,\r\n        type: 'categorical',\r\n        stops: stops\r\n      };\r\n\r\n      return height;\r\n    }\r\n  },\r\n  mounted: function () {\r\n    this.initMap();\r\n  }\r\n};\r\n</script>"]}]}